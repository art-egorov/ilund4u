
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-8.3.9">
    
    
      
        <title>Example-driven guide - iLund4u</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1dff34a1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2MTBEQBNYC"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-2MTBEQBNYC",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2MTBEQBNYC"></script>


    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="ilund4u_blue" data-md-color-accent="ilund4u_yellow">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-driven-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="iLund4u" class="md-header__button md-logo" aria-label="iLund4u" data-md-component="logo">
      
  
  <?xml version="1.0" encoding="UTF-8"?>
<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500">
  <path d="M233.703576745615464,427.256416679763788c7.333369773565209,4.493880934460321,16.504100586736058,4.58153700476214,23.921944907303441.228507746331161,50.132626006159626-29.419434862202252,238.137964177803951-148.749554434098172,200.44862634459605-263.45746735486955-.038701212821252-.160953878998953-.09111622448836-.295231716696435-.143214562194771-.456303087769811-13.348463600363175-43.859509781060297-53.757954843338666-75.923165964325563-101.793264469624773-76.344433085516357-27.075997864574674-.23745506717114-51.89797185122552,9.610385093721561-70.942033621216979,26.067702736280808l-.01351461696504.013279632835292c-.013513900568796.013197943029809-.040343952648982.026360800184193-.053858569615841.039640433006753-1.48227180887443,1.124700009913795-25.064705234497524,19.201953708738074-37.35273767684339,39.104905121658703-10.847787872680783-19.168879117740289-29.646930734423222-35.221834687822593-35.175457092377655-39.740973548275178-18.842202906597777-17.244625280741275-43.839161852159123-27.127838666213393-71.303267889790732-27.36869742151066-48.048788440949465-.421385329678742-89.005043205677794,31.397142829636323-103.120685642969875,75.01579385540299-.054996971637593.1601321508806-.114976038024906-.630068064120678-.156494195023697-.46981770473667C-1.665428560296277,273.921462364258332,184.128852320982332,396.877080057964122,233.703576745615464,427.256416679763788Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 43px;"/>
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            iLund4u
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Example-driven guide
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="ilund4u_blue" data-md-color-accent="ilund4u_yellow"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/art-egorov/ilund4u.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../Algorithm/algorithm/" class="md-tabs__link">
      Algorithm description
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Example-driven guide
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Parameters/cmd_parameters/" class="md-tabs__link">
        Parameters
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../API/usage_examples/" class="md-tabs__link">
        API
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../VersionLog/versions/" class="md-tabs__link">
      Version log
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../FAQ/FAQ/" class="md-tabs__link">
      FAQ
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="iLund4u" class="md-nav__button md-logo" aria-label="iLund4u" data-md-component="logo">
      
  
  <?xml version="1.0" encoding="UTF-8"?>
<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500">
  <path d="M233.703576745615464,427.256416679763788c7.333369773565209,4.493880934460321,16.504100586736058,4.58153700476214,23.921944907303441.228507746331161,50.132626006159626-29.419434862202252,238.137964177803951-148.749554434098172,200.44862634459605-263.45746735486955-.038701212821252-.160953878998953-.09111622448836-.295231716696435-.143214562194771-.456303087769811-13.348463600363175-43.859509781060297-53.757954843338666-75.923165964325563-101.793264469624773-76.344433085516357-27.075997864574674-.23745506717114-51.89797185122552,9.610385093721561-70.942033621216979,26.067702736280808l-.01351461696504.013279632835292c-.013513900568796.013197943029809-.040343952648982.026360800184193-.053858569615841.039640433006753-1.48227180887443,1.124700009913795-25.064705234497524,19.201953708738074-37.35273767684339,39.104905121658703-10.847787872680783-19.168879117740289-29.646930734423222-35.221834687822593-35.175457092377655-39.740973548275178-18.842202906597777-17.244625280741275-43.839161852159123-27.127838666213393-71.303267889790732-27.36869742151066-48.048788440949465-.421385329678742-89.005043205677794,31.397142829636323-103.120685642969875,75.01579385540299-.054996971637593.1601321508806-.114976038024906-.630068064120678-.156494195023697-.46981770473667C-1.665428560296277,273.921462364258332,184.128852320982332,396.877080057964122,233.703576745615464,427.256416679763788Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 43px;"/>
</svg>

    </a>
    iLund4u
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/art-egorov/ilund4u.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Algorithm/algorithm/" class="md-nav__link">
        Algorithm description
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Example-driven guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Example-driven guide
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-start" class="md-nav__link">
    Before start
  </a>
  
    <nav class="md-nav" aria-label="Before start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation" class="md-nav__link">
    Data preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#help-messages" class="md-nav__link">
    Help messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-compatible-gff-files-based-on-nucleotide-sequences" class="md-nav__link">
    Building compatible gff files based on nucleotide sequences
  </a>
  
    <nav class="md-nav" aria-label="Building compatible gff files based on nucleotide sequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pharokka-for-annotation-of-phage-genomes" class="md-nav__link">
    Using pharokka for annotation of phage genomes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-prokka-for-annotation-of-prokaryotic-genomes" class="md-nav__link">
    Using prokka for annotation of prokaryotic genomes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ilund4u-workflow" class="md-nav__link">
    iLund4u workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hotspot-annotation-mode" class="md-nav__link">
    Hotspot annotation mode
  </a>
  
    <nav class="md-nav" aria-label="Hotspot annotation mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-with-default-parameters" class="md-nav__link">
    Run with default parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-ilund4u-database" class="md-nav__link">
    Building the iLund4u database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-the-circularity-of-sequences" class="md-nav__link">
    Specifying the circularity of sequences
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protein-annotation-mode" class="md-nav__link">
    Protein annotation mode
  </a>
  
    <nav class="md-nav" aria-label="Protein annotation mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-with-default-parameters_1" class="md-nav__link">
    Run with default parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-homology-search-mode-and-setting-up-labels" class="md-nav__link">
    Specifying homology search mode and setting up labels
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proteome-annotation-mode" class="md-nav__link">
    Proteome annotation mode
  </a>
  
    <nav class="md-nav" aria-label="Proteome annotation mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-with-default-parameters_2" class="md-nav__link">
    Run with default parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-of-visualisation-types" class="md-nav__link">
    Review of visualisation types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ilund4u-databases" class="md-nav__link">
    iLund4u databases
  </a>
  
    <nav class="md-nav" aria-label="iLund4u databases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-database" class="md-nav__link">
    Downloading database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Parameters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Parameters" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Parameters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Parameters/cmd_parameters/" class="md-nav__link">
        Command-line parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Parameters/config_parameters/" class="md-nav__link">
        Configuration file parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API/usage_examples/" class="md-nav__link">
        Usage examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API/package/" class="md-nav__link">
        Library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../VersionLog/versions/" class="md-nav__link">
        Version log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ/FAQ/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="example-driven-guide">Example-driven guide</h1>
<p>Here we show usage examples of the iLund4u command-line interface. Through this guide we will show you step-by-step how to use our tool in three available modes: <strong>hotspot annotation</strong>, <strong>protein search</strong>, and <strong>proteome annotation</strong>.</p>
<h2 id="before-start">Before start</h2>
<h3 id="data-preparation">Data preparation</h3>
<p>The necessary sample data as well as adjustable tool configuration files are provided by iLund4u at the post-install step:  <br />
<code>ilund4u --data</code> which copies the folder <em>ilund4u_data</em> to your working directory. </p>
<p><strong>If you work on a Linux machine</strong> after installation you should run: <code>ilund4u --linux</code><br />
This command replaces the tools paths (MMseqs2) in the pre-made config files from the MacOS (default) to the Linux versions.<br />
If you run this command for fun and want to change it back you can use <code>ilund4u --mac</code>.</p>
<p><strong>Downloading HMM models:</strong> ilund4u uses pyhmmer for additional functional annotation of proteins with hmmscan versus a set of databases. You can download these database from our server (<a href="https://data-sharing.atkinson-lab.com/iLund4u/">data-sharing.atkinson-lab.com/iLund4u</a>) by running the following command:<br />
<code>ilund4u --get-hmms</code><br />
List of databases: AMR: AMRFinderPlus (v. 02.05.2024.2); Anti-defence: dbAPIS_Acr (v. 19.09.2023); Defence: DefenceFinder (v. 1.2.4), CasFinder (v. 3.1.0); PADLOC (v. 22.10.2024); Virulence: VFDB (v. 10.05.2024).</p>
<p><ins>For this demonstration we will use pharokka-generated gff files with sequences of 70 P2-like phages.<br />
Gff files are stored at: <em>ilund4u_data/guide/gff_files</em>.</ins>    <br />
The main difference of pharokka/prokka generated gff files from a regular gff3 (for ex. which you can download from the NCBI) is that in addition to annotation rows they contain the corresponding nucleotide sequence in fasta format. </p>
<p><strong>Note:</strong> Each gff file should contain a corresponding nucleotide sequence. iLund4u is designed to handle pharokka/prokka produced annotation files.  </p>
<h3 id="help-messages">Help messages</h3>
<p>To show the main iLund4u help message you can use <code>ilund4u --help</code>.<br />
To show mode-specific help messages use: <code>ilund4u --help [mode]</code> (e.g. <code>ilund4u --help hotspots</code>)</p>
<h3 id="building-compatible-gff-files-based-on-nucleotide-sequences">Building compatible gff files based on nucleotide sequences</h3>
<p>If your query set of sequences for hotspot annotation contains only nucleotide fasta files, below we will provide the efficient way of using <a href="https://pharokka.readthedocs.io/en/latest/">pharokka</a> (phage annotation pipeline) and <a href="https://github.com/tseemann/prokka">prokka</a> (prokaryotic genome annotation pipeline) for preparing gff files compatible with iLund4u. </p>
<h4 id="using-pharokka-for-annotation-of-phage-genomes">Using pharokka for annotation of phage genomes</h4>
<p>Before running pharokka you need to install pharokka databases (and pharokka itself, of course). Due to the number of non-python dependencies we recommend using a conda environment for this task. See <a href="https://pharokka.readthedocs.io/en/latest/install/">pharokka documentation page</a> for clear instructions.</p>
<p>Firstly, if you have up to ~1000 nucleotide sequences we recommend merging them into one fasta file (could be done simply by using cat: <code>cat folder_with_fasta_files/*.fa &gt; merged_fasta.fa</code>.<br />
We recommend to merge multiple sequences to one file and using meta mode since in that case we do not load databases for each contig while annotating. </p>
<p>Then, you can use pharokka in meta mode with one command:<br />
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pharokka.py<span class="w"> </span>-i<span class="w"> </span>merged_fasta.fa<span class="w">  </span>-o<span class="w"> </span>pharokka_output<span class="w">  </span>--meta<span class="w"> </span>--split<span class="w"> </span>-t<span class="w"> </span>Num_of_threads<span class="w"> </span><span class="se">\</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span>--skip_mash<span class="w"> </span>--dnaapler<span class="w">  </span>-database<span class="w"> </span>path_do_pharokka_database<span class="w"> </span>
</span></code></pre></div></p>
<p>Gff files for each query contig will be stored at: <em>pharokka_output/single_gffs</em></p>
<p>In case you have thousands of input sequences we recommend splitting them into several fasta files with ~1000 sequences in each. Then you can run pharokka on these sets of sequences. One of the ways to parallelise this process is shown below:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">for</span><span class="w"> </span>f<span class="w"> </span><span class="k">in</span><span class="w"> </span>folder_with_fasta/*.fa<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">fb</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="nv">$f</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="nv">nm</span><span class="o">=</span><span class="si">${</span><span class="nv">fb</span><span class="p">//.fa/</span><span class="si">}</span><span class="p">;</span><span class="w"> </span><span class="se">\ </span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>pharokka.py<span class="w"> </span>-i<span class="w"> </span><span class="nv">$f</span><span class="w">  </span>-o<span class="w"> </span>pharokka_batches/<span class="nv">$nm</span><span class="w">  </span>--meta<span class="w"> </span>--split<span class="w"> </span>-t<span class="w"> </span>Num_of_threads<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span>--skip_mash<span class="w"> </span>--dnaapler<span class="w">  </span>--database<span class="w"> </span>bin/pharokka/databases<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>parallel<span class="w"> </span>-j<span class="w"> </span>Num_of_parallel_processes
</span></code></pre></div>
Here you set Num_of_threads・Num_of_parallel_processes equal to the number threads you want to use.</p>
<p>Then you can move generated gff files to one folder using:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">for</span><span class="w"> </span>f<span class="w"> </span><span class="k">in</span><span class="w"> </span>pharokka_batches/*<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>mv<span class="w"> </span><span class="nv">$f</span>/single_gffs/*<span class="w"> </span>pharokka_gffs/<span class="p">;</span><span class="w"> </span><span class="k">done</span>
</span></code></pre></div></p>
<h4 id="using-prokka-for-annotation-of-prokaryotic-genomes">Using prokka for annotation of prokaryotic genomes</h4>
<p>Prokka does not have an equivalent of meta mode which we used in pharokka in the example above. Therefore, for any number of input sequences we prefer running prokka independently for each contig instead of dividing more complex gff files, which requires an additional step. Again, for prokka installation instruction and parameter description see  <a href="https://github.com/tseemann/prokka">prokka documentation page</a>.</p>
<p>In case your input fasta query files (<ins>one sequence per file</ins>) are located in <em>single_records</em> folders you can run:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">for</span><span class="w"> </span>f<span class="w"> </span><span class="k">in</span><span class="w"> </span>single_records/*.fa<span class="p">;</span><span class="w">  </span><span class="k">do</span><span class="w"> </span><span class="nv">fb</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="nv">$f</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="nv">nm</span><span class="o">=</span><span class="si">${</span><span class="nv">fb</span><span class="p">//.fa/</span><span class="si">}</span><span class="p">;</span><span class="w"> </span><span class="se">\ </span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>prokka<span class="w"> </span>--outdir<span class="w"> </span>prokka/<span class="nv">$nm</span><span class="w"> </span>--prefix<span class="w"> </span><span class="nv">$nm</span><span class="w"> </span>--quiet<span class="w"> </span>--cpus<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nv">$f</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>parallel<span class="w"> </span>-j<span class="w"> </span>num_of_available_threads
</span></code></pre></div>
Then you can move generated gff files to one folder using:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">for</span><span class="w"> </span>f<span class="w"> </span><span class="k">in</span><span class="w"> </span>prokka/*<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">fb</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="nv">$f</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>mv<span class="w">  </span><span class="nv">$f</span>/<span class="nv">$fb</span>.gff<span class="w"> </span>prokka_gffs/<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>parallel
</span></code></pre></div></p>
<h2 id="ilund4u-workflow">iLund4u workflow</h2>
<figure style="align:center; margin-top: 0; margin-bottom: 0;">
    <a class="glightbox" href="../../img/ilundu4_pipeline.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="pipeline" loading="lazy" src="../../img/ilundu4_pipeline.png" width="100%" /></a><br />
    <figcaption style="margin-top: 0; margin-bottom: 0;">Figure 1. iLund4u workflow</figcaption>
</figure>
<h2 id="hotspot-annotation-mode">Hotspot annotation mode</h2>
<h3 id="run-with-default-parameters">Run with default parameters</h3>
<p>Let's start with the main mode of iLund4u - hotspot annotation (see the workflow Figure 1).<br />
The only mandatory argument for this mode is a folder path containing compatible gff files.
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>ilund4u hotspots --gff ilund4u_data/guide/gff_files
</span></code></pre></div>
With the first argument after ilund4u we specified the mode of usage <code>hotspots</code>.   </p>
<details class="card_heart_cog">
<summary><strong>Log messages for the example run with default parameters</strong></summary>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>○ Reading gff files...
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 70/70
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>○ Running mmseqs for protein clustering...
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  ⦿ 166 clusters for 2847 proteins were found with mmseqs
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>  ⦿ mmseqs clustering results were saved to ilund4u_2024_10_01-23_11/mmseqs/mmseqs_clustering.tsv
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>○ Processing mmseqs results ...
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 70/70
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>  ⦿ 0 proteomes were excluded after proteome deduplication and filtering
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>○ Proteomes network construction...
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 70/70
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>  ⦿ Network building elapsed time: 0.03 sec
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>  ⦿ Proteomes network with 2413 connections was built
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>  ⦿ Network was saved as ilund4u_2024_10_01-23_11/proteome_network.gml
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>○ Proteome network partitioning using the Leiden algorithm...
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>  ⦿ 1 proteome communities were found
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>  ⦿ 1 proteomes communities with size &gt;= 10 were taken for further analysis
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>  ⦿ 0 proteomes from smaller communities were excluded from the analysis
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>○ Defining protein classes within each community...
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 1/1
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>○ Annotating variable islands within each proteome...
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>  ⦿ 176 variable regions are annotated in 70 proteomes (2.514 per proteome)
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>○ Island network construction within each proteome community...
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 1/1
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>  ⦿ Island network building elapsed time: 0.09 sec
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>○ Searching for hotspots within each community...
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 1/1
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>  ⦿ 2 hotspots were found in 1 proteome communities  (Avg: 2.0 per community)
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>  2/2 hotspots are flanked (consist of islands that have conserved genes on both sides)
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>○ Preparing data for additional island protein annotation with pyhmmer hmmscan...
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>  ⦿ Running pyhmmer hmmscan versus DefenceFinder and CasFinder Databases...
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 135/135
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>    Number of hits: 21
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>  ⦿ Running pyhmmer hmmscan versus Virulence Factor Database...
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 135/135
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>    Number of hits: 3
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>  ⦿ Running pyhmmer hmmscan versus Anti-Prokaryotic Immune Systems Database (dbAPIS)...
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 135/135
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>    Number of hits: 0
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>  ⦿ Running pyhmmer hmmscan versus AMRFinderPlus Database...
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 135/135
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>    Number of hits: 0
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>○ Hotspot network construction...
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2/2
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>○ Hotspot network partitioning using the Leiden algorithm...
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>  ⦿ 0 hotspots were merged to 0 not singleton communities
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>○ Hotspot and island statistics calculation...
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>○ Protein group statistics calculation...
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2/2
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>○ Visualisation of hotspot communities using lovis4u...
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2/2
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>○ Visualisation of proteome communities with corresponding hotspots using lovis4u...
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>  ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 1/1
</span></code></pre></div>
<strong>Note:</strong> you can use <code>-q</code>, <code>--quite</code> command-line argument to hide progress messages. </p>
</details>
<p>By running this command, an output folder named ilund4u_{current_date} (e.g. ilund4u_2024_06_25-16_36) will be created.<br />
The name of the output folder can be changed with <code>-o &lt;output_folder_name&gt;</code>.  </p>
<details class="card_hearts">
<summary><strong>Output folder structure</strong></summary>
<ul>
<li><strong><em>all_proteins.fa</em></strong> - fasta file with all proteins encoded by input genomes.</li>
<li><strong><em>mmseqs</em></strong> - folder containing mmseqs clustering results.  </li>
<li><strong><em>dropped_sequences.tsv</em></strong> - table containing information about dropped sequences during the deduplication process (in order not to analyse several sequences with identical sets of protein groups).</li>
<li><strong><em>proteome_network.gml</em></strong> - proteome network in gml format.</li>
<li><strong><em>proteome_communities.tsv</em></strong> - proteome communities and annotation based on proteome network partitioning using the Leiden algorithm.</li>
<li><strong><em>protein_group_classes.tsv</em></strong> - annotation table for each protein group (set of homologous proteins defined by mmseqs clustering) with a group presence in a community of proteomes and corresponding class.</li>
<li><strong><em>island_networks</em></strong> - folder containing networks of islands in gml format.</li>
<li><strong><em>island_annotation.tsv</em></strong> - table with annotation of islands (regions of non-conserved proteins in each proteome).</li>
<li><strong><em>island_rep_proteins.fa</em></strong> - fasta file with representative island proteins.  </li>
<li><strong><em>hmmscan</em></strong> - folder containing pyhmmer search output.</li>
<li><strong><em>hotspot_annotation.tsv</em></strong> - annotation table of identified hotspots.</li>
<li><strong><em>hotspot_network.gml</em></strong> - network of hotspots in gml format.</li>
<li><strong><em>hotspot_communities.tsv</em></strong> - hotspot communities -we can expect that hotspots identified in different proteome communities could have the same flanking genes That is why we cluster together such hotspots. This file describes such communities.</li>
<li><strong><em>hotspot_community_annotation.tsv</em></strong> - annotation table of identified hotspot communities.</li>
<li><strong><em>protein_group_accumulated_statistics.tsv</em></strong> - annotation table of protein groups identified as "variable" or/and encoded in hotspots.</li>
<li><strong><em>lovis4u_proteome_communities</em></strong> - folder with LoVis4u visualisation of proteome communities.</li>
<li><strong><em>lovis4u_hotspots</em></strong> - folder with LoVis4u visualisation of each hotspot community.</li>
<li><strong><em>lovis4u_hotspots_annotation</em></strong> - folder with LoVis4u annotation tables for hotspot visualisation.  </li>
</ul>
</details>
<figure style="float: right; margin: 0; padding: 0;">
    <a class="glightbox" href="img/proteome_com_def_run.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img align="right" alt="f2" loading="lazy" margin="0" padding="0" src="img/proteome_com_def_run.png" width="440" /></a><br />
    <figcaption style="margin: 0; padding: 0;">Figure 2</figcaption>
</figure>
<p>In the example above we used 70 P2-like phages that are known to be in one community (group of related proteomes) based on our iLund4u hotspot annotation run on 873K phage sequences. As expected we find all sequences to be members of one community of proteomes with average proteome composition similarity (fraction of shared protein homologues) equal to 0.856 (see <em>proteome_communities.tsv</em> table and <em>proteome_network.gml</em> network files).</p>
<p>On the visualisation of full length sequences from the proteome community (Fig. 2) built with <a href="https://art-egorov.github.io/lovis4u/">LoVis4u</a> we can see two annotated hotspots highlighted.<br />
The presence of hotspots in P2-like phages has previously been reported and it is known that these hotspots (highlighted in red is known as <em>old/tin</em>-encoding, while highlighted in blue as <em>Z/fun</em>-encoding) contain diverse anti-phage defence cargo proteins  <em>(See <a href="https://doi.org/10.1016/j.chom.2022.02.018">Francois, et al., 2022</a>; <a href="https://doi.org/10.1038/s41564-022-01219-4">Vassallo, et. Al, 2022</a>)</em>.<br />
iLund4u indicates that some genomes contain virulence factors (cytolethal distending toxin (CDT) [VF0987]) in the same hotspot locus (it was reported in  <em><a href="https://doi.org/10.1016/j.chom.2022.02.018">Francois, et al., 2022</a>))</em>.</p>
<p>On the proteome community figure (Fig. 2) you can see that most of the differences in terms of proteome composition between phages are concentrated in these two hotspots. However, there are also other variable regions with at least one non-conserved protein coding gene distributed across genomes. However, iLund4u does not merge these with other hotspots due to not passing the presence cutoff. Such genes are shown with in dark grey while conserved (or core) protein coding genes are light grey.</p>
<p>Below you can see LoVis4u visualisation of each hotspot loci - cargo proteins and up to 10 conserved flanking genes. </p>
<details class="card_figure_red">
<summary><strong>LoVis4u visualisation of <em>old/tin</em>-encoding hotspot (0-0)</strong> <em>(Figure 3)</em></summary>
<p><a class="glightbox" href="img/0-0.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-0" loading="lazy" src="img/0-0.png" width="100%" /></a>  </p>
</details>
<details class="card_figure_blue">
<summary><strong>LoVis4u visualisation of <em>Z/fun</em>-encoding hotspot (0-1)</strong> <em>(Figure 4)</em></summary>
<p><a class="glightbox" href="img/0-1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-1" loading="lazy" src="img/0-1.png" width="100%" /></a>  </p>
</details>
<h3 id="building-the-ilund4u-database">Building the iLund4u database</h3>
<p>As you can see in the workflow (Fig. 1), during hotspot annotation, iLund4u can also create a database that then can be used for two other modes: protein and proteome annotation.<br />
To create a database in addition to hotspot annotation you need to add the argument <code>-o-db &lt;dir name&gt;</code> or <code>--output-database &lt;dir name&gt;</code> with the specified database folder name. For example:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ilund4u<span class="w"> </span>hotspots<span class="w"> </span>--gff<span class="w"> </span>ilund4u_data/guide/gff_files<span class="w"> </span>-o<span class="w"> </span>P2-like_phages_guide<span class="w">  </span>-o-db<span class="w"> </span>P2-like_phages_guide_DB
</span></code></pre></div>
This database, which is built on a guide set of 70 P2-like phages annotation gff files, is also available in the ilundu4_data folder under the following path: <em>ilund4u_data/guide/like_phages_guide_DB</em>. </p>
<h3 id="specifying-the-circularity-of-sequences">Specifying the circularity of sequences</h3>
<p>Another important optional argument is  <code>-gct, --genome-circularity-table &lt;path&gt;</code> which takes path to a table containing information for each genome about whether it is circular or not. Format: tab-separated; column names: <em>id</em>, <em>circular</em>. Values 1 or 0. For genomes in which the id is not listed in this table, the default value will be 0 (non circular) ; You can use <code>-cg/--circular-genomes</code> to change the default value to 1 (circular).<br />
This parameter is important since if the genome is circular then the first and last proteins will be considered as neighbours, which affects the flanking gene sets of proteins located near the ends of sequences. Since for these phages in the example we have circular genomes and this value is default, you can see that the breaks between the end and start of contigs are ignored for hotspot 0-0 (Fig. 3).  </p>
<p><strong>Please be aware</strong> that if a genome is not considered circular, islands located at the ends of sequences (flanked from only one side) will <strong>NOT</strong> be considered in clustering to hotspots by default. This is the standard iLund4u behaviour. However, you can force to consider them by using the <code>-rnf, --report-not-flanked</code> parameter. Note that each result table (for islands, hotspots, hotspot communities, and protein groups) includes a column indicating whether the object is flanked or not.</p>
<hr />
<h2 id="protein-annotation-mode">Protein annotation mode</h2>
<h3 id="run-with-default-parameters_1">Run with default parameters</h3>
<p>For the demonstration of protein annotation mode we took the protein <a href="https://www.ncbi.nlm.nih.gov/protein/WP_171864480.1/">WP_171864480.1</a> , which  is annotated as E. coli RloC in the <a href="https://defensefinder.mdmlab.fr/wiki/refseq">Defense Finder database</a>. We chose RloC since it is an annotated cargo protein and is found on both of our annotated hotspots.<br />
Here we can also start with only the mandatory arguments set: <code>-fa &lt;fasta_path&gt;</code> - path to a fasta file with query protein amino acid sequence and <code>-db &lt;db_path&gt;</code> - path to iLund4u database folder. Again, optionally you can specify an output folder name using <code>-o &lt;folder_name&gt;</code> parameter.
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>ilund4u protein -fa  ilund4u_data/guide/RloC.fa -db ilund4u_data/guide/P2-like_phages_guide_DB -o RloC_search
</span></code></pre></div></p>
<details class="card_heart_cog">
<summary><strong>Log messages for the example run with default parameters</strong></summary>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>○ Loading database from ilund4u_data/guide/P2-like_phages_guide_DB...
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>○ Loading cds objects...
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2847/2847
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>○ Loading island objects...
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 176/176
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>○ Loading proteome objects...
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 70/70
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>○ Loading hotspot objects...
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2/2
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>⦿ The ilund4u_data/guide/P2-like_phages_guide_DB database was successfully loaded
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>○ Running mmseqs for protein search versus the database of proteins...
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    ⦿ A homologous group was found for 1/1 query protein
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>○ Searching for hotspots with your query protein homologues...
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>⦿ Query protein homologues were found in 2 hotspot communities (2 hotspots) on 4 islands
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>    Found as cargo: 4, as flanking gene: 0
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>    4/4 islands where found as cargo are both side flanked (have conserved genes on both sides)
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>⦿ Homologous proteins were saved to RloC_search/homologous_proteins.fa and the MSA was visualised with MSA4u
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>○ Visualisation of the hotspot(s) with your query protein homologues using lovis4u...
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>⦿ Done!
</span></code></pre></div>
</details>
<details class="card_hearts">
<summary><strong>Output folder structure</strong></summary>
<ul>
<li><strong><em>mmseqs_homology_search_full.tsv</em></strong> - table with identified homologues.</li>
<li><strong><em>mmseqs</em></strong> - folder containing mmseqs results and logs.  </li>
<li><strong><em>homologous_proteins.fa</em></strong> - fasta file containing query protein and identified homologues.</li>
<li><strong><em>homologous_proteins_aln.fa</em></strong> - alignment fasta file containing query protein and identified homologues built with MAFFT.</li>
<li><strong><em>msa4u_homologous_proteines.pdf</em></strong> - MSA4u visualisation of the protein alignment.</li>
<li><strong><em>protein_group_stat.tsv</em></strong> - annotation table of protein group(s) that are homologoues to the query. </li>
<li><strong><em>found_island_annotation.tsv</em></strong> - annotation table of islands containing query protein homologues.</li>
<li><strong><em>found_hotspot_annotation.tsv</em></strong> - annotation table of hotspots containing query protein homologues. </li>
<li><strong><em>lovis4u_full</em></strong> - folder containing LoVis4u visualisation of hotspots where query protein homologues are found.</li>
<li><strong><em>lovis4u_with_query</em></strong> - folder containing LoVis4u visualisation of hotspots with only loci where query protein homologues are found.</li>
<li><strong><em>lovis4u_hotspots_annotation</em></strong> - folder with LoVis4u annotation tables for hotspot visualisation.  </li>
</ul>
</details>
<p><strong>Note:</strong> iLund4u searches for homology not only versus cargo proteins but against flanking genes as well.</p>
<h3 id="specifying-homology-search-mode-and-setting-up-labels">Specifying homology search mode and setting up labels</h3>
<p>Protein annotation mode has three important optional arguments that we want to describe here.  </p>
<p>The first one: <code>-hsm, --homology-search-mode &lt;group|proteins&gt;</code>  which specifies the mode of search for homologous proteins in the database. If "group" is selected, a query protein is assigned to the same homologous group as that of the best search hit protein. In "proteins" mode, all target proteins that pass the cutoffs are considered to be homologues. By default, "group" mode is set. We recommend to use "proteins" mode if you want to find more diverse set of homologues.  </p>
<p>The second is: <code>-rnf, --report-not-flanked</code> controls whether islands and hotspots located at the ends of sequences (flanked from only one side) will be considered in search. The importance of it described in the hotspot annotation section which has exactly the same argument. </p>
<p>The last one we want to highlight is <code>-ql, --query-label &lt;str&gt;</code> which simply changes the label of your query protein homologues on LoVis4u visualisation. For example:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>ilund4u<span class="w"> </span>protein<span class="w"> </span>-fa<span class="w">  </span>ilund4u_data/guide/RloC.fa<span class="w"> </span>-db<span class="w"> </span>ilund4u_data/guide/P2-like_phages_guide_DB<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span>-o<span class="w"> </span>RloC_search<span class="w"> </span>-ql<span class="w"> </span><span class="s2">&quot;RloC from the guide&quot;</span>
</span></code></pre></div>
Below you can see visualisation of the same 0-0 and 0-1 hotspots with highlighted RloC proteins</p>
<details class="card_figure_red">
<summary><strong>LoVis4u visualisation of <em>old/tin</em>-encoding hotspot (0-0) with RloC</strong> <em>(Figure 5)</em></summary>
<p><a class="glightbox" href="img/0-0_RloC.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-0_1" loading="lazy" src="img/0-0_RloC.png" width="100%" /></a>  </p>
</details>
<details class="card_figure_blue">
<summary><strong>LoVis4u visualisation of <em>Z/fun</em>-encoding hotspot (0-1) with RloC</strong> <em>(Figure 6)</em></summary>
<p><a class="glightbox" href="img/0-1_RloC.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-1_1" loading="lazy" src="img/0-1_RloC.png" width="100%" /></a>  </p>
</details>
<p>Additionally, iLund4u returns visualisation (on one figure) of all loci where only query protein homologues are found (Fig. 7):</p>
<figure style="align:center; margin-top: 0; margin-bottom: 0;">
    <a class="glightbox" href="img/0-0_0-1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-0_0-1" loading="lazy" src="img/0-0_0-1.png" width="900" /></a><br />
    <figcaption style="margin-top: 0; margin-bottom: 0;">Figure 7</figcaption>
</figure>
<hr />
<h2 id="proteome-annotation-mode">Proteome annotation mode</h2>
<h3 id="run-with-default-parameters_2">Run with default parameters</h3>
<p>For demonstration of proteome annotation mode we took <em>Enterobacteria phage P2</em> <a href="https://www.ncbi.nlm.nih.gov/nuccore/NC_001895.1/">NC_001895.1</a> that is also known to be a member of the community of listed test set of phages based on our analysis of all phages (and which actually contains <em>old/tin</em> and <em>Z/fun</em>).<br />
In this mode mandatory arguments are <code>-gff &lt;gff_path&gt;</code> - path to gff file (again, pharokka/prokka annotated) of your query proteome and <code>-db &lt;db_path&gt;</code> - path to a database. Optionally you can specify output folder name using <code>-o &lt;folder_name&gt;</code> parameter.
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>ilund4u<span class="w"> </span>proteome<span class="w"> </span>-gff<span class="w">  </span>ilund4u_data/guide/NC_001895.1.gff<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span>-db<span class="w"> </span>ilund4u_data/guide/P2-like_phages_guide_DB<span class="w"> </span>-o<span class="w"> </span>NC_001895.1_search
</span></code></pre></div></p>
<details class="card_heart_cog">
<summary><strong>Log messages for the example run with default parameters</strong></summary>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>○ Loading database from ilund4u_data/guide/P2-like_phages_guide_DB...
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>○ Loading cds objects...
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2847/2847
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>○ Loading island objects...
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 176/176
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>○ Loading proteome objects...
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 70/70
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>○ Loading hotspot objects...
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 2/2
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>⦿ The ilund4u_data/guide/P2-like_phages_guide_DB database was successfully loaded
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>○ Reading gff file...
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>○ Running mmseqs for protein search versus the database of proteins...
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>  ⦿ A homologous group was found for 39/42 query proteins
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>○ Searching for similar proteomes in the database network
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>○ Preparing data for protein annotation with pyhmmer hmmscan...
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>  ⦿ Running pyhmmer hmmscan versus DefenceFinder and CasFinder Databases...
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 42/42
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    Number of hits: 1
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>  ⦿ Running pyhmmer hmmscan versus Virulence Factor Database...
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 42/42
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>    Number of hits: 0
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>  ⦿ Running pyhmmer hmmscan versus Anti-Prokaryotic Immune Systems Database (dbAPIS)...
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 42/42
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>    Number of hits: 0
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>⦿ Running pyhmmer hmmscan versus AMRFinderPlus Database...
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>    ◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉◉ 42/42
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>    Number of hits: 0
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>⦿ 70 similar proteomes were found in the database network with max proteome similarity = 0.92
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>⦿ The query proteome was assigned to a community (id: 0) with connection to 1.0 of its members with avg weight = 0.86
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>⦿ Protein class distribution in query proteome: 36 conserved, 5 variable, 1 intermediate
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>⦿ 3 variable islands were annotated in the query proteome
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>⦿ 2 of annotated variable islands were mapped to the database hotspots
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>○ Lovis4u visualisation of communities and proteomes...
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a>○ Lovis4u visualisation found hotspots..
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a>⦿ Done!
</span></code></pre></div>
</details>
<details class="card_hearts">
<summary><strong>Output folder structure</strong></summary>
<ul>
<li><strong><em>all_proteins.fa</em></strong> - fasta file with query sequence proteins.</li>
<li><strong><em>mmseqs</em></strong> - folder containing mmseqs results and logs.  </li>
<li><strong><em>mmseqs_homology_search_full.tsv</em></strong> - table containing results of finding protein homologues for all proteins from the query proteome.</li>
<li><strong><em>hmmscan</em></strong> - folder containing additional functional annotation of <em>all</em> query sequence proteins versus a set of databases with pyhmmer. </li>
<li><strong><em>query_proteome_network.tsv</em></strong> - sequence id and weights of all edges to the database network of proteomes.</li>
<li><strong><em>similar_proteome_communities.tsv</em></strong> - table containing annotation of proteome communities with similar proteomes to your query.    - <strong><em>query_protein_clusters.tsv</em></strong> - annotation of query sequence protein classes - variable/intermediate/conserved depending on their presence in proteome community.</li>
<li><strong><em>protein_group_stat.tsv</em></strong> - annotation table of protein group(s) that are homologoues to the query proteins. </li>
<li><strong><em>island_to_hotspot_mapping.tsv</em></strong> - mapping of variable islands (regions with at least one non-conserved proteins in your query sequence) that were annotation as hotspots in the database.</li>
<li><strong><em>annotation_of_mapped_hotspots.tsv</em></strong> - annotation of mapped hotspots containing their description and statistics.</li>
<li><strong><em>lovis4u_proteome_community_hotspots.pdf</em></strong>* - LoVis4u visualisation of all members of proteome community with your query sequence where hotspots are highlighted.</li>
<li><strong><em>lovis4u_proteome_community.pdf</em></strong> - LoVis4u visualisation of all members of proteome community with your query sequence where highlighted all non-conserved proteins (found in a small fraction of proteomes within the community).  </li>
<li><strong><em>lovis4u_query_proteome_hotspot.pdf</em></strong> - LoVis4u visualisation of only query proteome with highlighted hotspots.</li>
<li><strong><em>lovis4u_query_proteome_variable.pdf</em></strong> - LoVis4u visualisation of only query proteome with highlighted non-conserved proteins.</li>
<li><strong><em>lovis4u_hotspot_full</em></strong> - folder containing LoVis4u visualisation of hotspots with your query proteome.</li>
<li><strong><em>lovis4u_hotspot_with_query</em></strong> - folder containing LoVis4u visualisation of hotspots but only with your query proteome.</li>
<li><strong><em>lovis4u_hotspots_annotation</em></strong> - folder with LoVis4u annotation tables for hotspot visualisation.  </li>
</ul>
</details>
<h3 id="review-of-visualisation-types">Review of visualisation types</h3>
<p>This mode returns several types of visualisation built with LoVis4u.<br />
Firstly, it includes visualisation of your query proteome together with all other proteomes from a proteome community to which your query sequence was assigned.</p>
<details class="card_figure">
<summary><strong>LoVis4u visualisation of a proteome community + query sequence with hotspots highlighted</strong> <em>(Figure 8)</em></summary>
<p><a class="glightbox" href="img/lovis4u_proteome_community_hotspots.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-0_1" loading="lazy" src="img/lovis4u_proteome_community_hotspots.png" width="100%" /></a>  </p>
</details>
<details class="card_figure">
<summary><strong>LoVis4u visualisation of a proteome community + query sequence with non-conserved proteins highlighted</strong> <em>(Figure 9)</em></summary>
<p><a class="glightbox" href="img/lovis4u_proteome_community.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-0_1" loading="lazy" src="img/lovis4u_proteome_community.png" width="100%" /></a>  </p>
</details>
<p>Additionally, iLund4u generates LoVis4u visualisation of only your query sequence highlighting annotated hotspots:</p>
<figure style="align:center; margin-top: 0; margin-bottom: 0;">
    <a class="glightbox" href="img/lovis4u_query_proteome_hotspot.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="qph" loading="lazy" src="img/lovis4u_query_proteome_hotspot.png" width="100%" /></a> 
    <figcaption style="margin-top: 0; margin-bottom: 0;">Figure 10</figcaption>
</figure>
<p>Or highlighting non-conserved proteins based on a group of homologues corresponding to a protein and its presence in a community of proteomes. As you can see, non-conserved proteins that were not assigned to any hotspot are shown in more dark grey colour on the Fig. 10.</p>
<figure style="align:center; margin-top: 0; margin-bottom: 0;">
    <a class="glightbox" href="img/lovis4u_query_proteome_variable.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="qpv" loading="lazy" src="img/lovis4u_query_proteome_variable.png" width="100%" /></a> <br />
    <figcaption style="margin-top: 0; margin-bottom: 0;">Figure 11</figcaption>
</figure>
<p>Moreover, iLund4u plots each annotated hotspots in the same way: figures containing all proteomes from a community with your query proteome and only loci of your proteome (Fig. 12, 13).</p>
<details class="card_figure_red">
<summary><strong>LoVis4u visualisation of <em>old-tin</em> hotspot (0-0) with query sequence</strong> <em>(Figure 12)</em></summary>
<p><a class="glightbox" href="img/0-0_wq.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-0_1" loading="lazy" src="img/0-0_wq.png" width="100%" /></a>  </p>
</details>
<p>As you can see on Fig. 12, we have a hit to a Defense Finder database with a cargo protein encoded in our query sequence on the <em>old-tin</em> hotspot (as expected to <em>old</em> even though <em>tin</em> remains unannotated by pharokka and pyhmmer).</p>
<details class="card_figure_blue">
<summary><strong>LoVis4u visualisation of <em>Z/fun</em> hotspot (0-1) with query sequence</strong> <em>(Figure 13)</em></summary>
<p><a class="glightbox" href="img/0-1_wq.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-1_1" loading="lazy" src="img/0-1_wq.png" width="100%" /></a>  </p>
</details>
<p>As we mentioned above, we also have LoVis4u visualisation of each hotspot with only query proteome locus. Below on Fig. 14 we show <em>old-tin</em> hotspot (0-0) locus of our query P2 phage. We see (as expected) that one out of three cargo proteins has a hit to the <a href="https://defensefinder.mdmlab.fr/wiki/defense-systems/old_exonuclease">OLD exonuclease</a> of Defense Finder database. </p>
<figure style="align:center; margin-top: 0; margin-bottom: 0;">
    <a class="glightbox" href="img/0-0_oq.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="0-1_1" loading="lazy" src="img/0-0_oq.png" width="900" /></a><br />
    <figcaption style="margin-top: 0; margin-bottom: 0;">Figure 14</figcaption>
</figure>
<hr />
<h2 id="ilund4u-databases">iLund4u databases</h2>
<figure style="float: right; margin: 0; padding: 0;">
    <a class="glightbox" href="../../img/ilund4u_dbs_wo_header.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img align="right" alt="f2" loading="lazy" margin="0" padding="0" src="../../img/ilund4u_dbs_wo_header.png" width="400" /></a><br />
    <figcaption style="width: 100; margin: 0; padding: 0;">Figure 15</figcaption>
</figure>
<p>iLund4u has two precomputed databases of hotspots built on phage and plasmid sequences (Fig. 15).<br />
The database of phages was built based on running hotspot annotation mode on all available <a href="https://phagescope.deepomics.org">PhageScope database</a> sequences (~870K sequences, version of September 2024). For plasmids database we took <a href="https://genome.jgi.doe.gov/portal/IMG_PR/IMG_PR.home.html">IMG/PR database of plasmids</a> (~700K sequences, version of June 2024).  </p>
<div style="clear: both;"></div>

<h3 id="downloading-database">Downloading database</h3>
<p>To download iLund4u database from our server [<a href="https://data-sharing.atkinson-lab.com/iLund4u/">data-sharing.atkinson-lab.com/iLund4u</a>] you can use the following command: <code>--database &lt;phages|plasmids&gt;</code>. For example, to get plasmids database you need to run:<br />
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>ilund4u --database plasmids
</span></code></pre></div></p>
<p><strong>Database sizes:</strong> Phages: 6.2GB; Plasmids: 1.12GB </p>
<hr />

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../Algorithm/algorithm/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Algorithm description" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Algorithm description
            </div>
          </div>
        </a>
      
      
        
        <a href="../../Parameters/cmd_parameters/" class="md-footer__link md-footer__link--next" aria-label="Next: Command-line parameters" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Command-line parameters
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "announce.dismiss", "navigation.tabs", "toc.integrate", "header.autohide"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c99f48ec.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>